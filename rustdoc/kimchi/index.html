<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="CI dependency status"><meta name="keywords" content="rust, rustlang, rust-lang, kimchi"><title>kimchi - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../kimchi/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../kimchi/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate kimchi</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></div></ul><section><div class="block"><ul><li><a href="#modules">Modules</a></li></ul></div></section><div id="sidebar-vars" data-name="kimchi" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../kimchi/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">kimchi</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/kimchi/lib.rs.html#1-18">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><a href="https://github.com/o1-labs/proof-systems/actions/workflows/rust.yml"><img src="https://github.com/o1-labs/proof-systems/actions/workflows/rust.yml/badge.svg" alt="CI" /></a>
<a href="https://deps.rs/repo/github/o1-labs/proof-systems"><img src="https://deps.rs/repo/github/o1-labs/proof-systems/status.svg?style=flat-square" alt="dependency status" /></a></p>
<h2 id="kimchi"><a href="#kimchi">Kimchi</a></h2>
<p>This repository contains <strong>kimchi</strong>, a general-purpose zero-knowledge proof system for proving the correct execution of programs.</p>
<p>You can read more about this project on the <a href="https://o1-labs.github.io/proof-systems">Kimchi book</a>.</p>
<p><a href="https://o1-labs.github.io/proof-systems/rustdoc">See here for the rust documentation</a>.</p>
<h3 id="example"><a href="#example">Example</a></h3>
<p>We assume that you already have:</p>
<ul>
<li><code>gates</code>: a circuit, which can be expressed as a vector of <a href="https://o1-labs.github.io/proof-systems/rustdoc/kimchi/circuits/gate/struct.CircuitGate.html">CircuitGate</a></li>
<li>a way to produce a <code>witness</code>, which can be expressed as a <code>[Vec&lt;F&gt;; COLUMNS]</code> (for <code>F</code> some field of your chosing)</li>
<li><code>public_size</code>: the size of the public input</li>
</ul>
<p>Then, you can create an URS for your circuit in the following way:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code><span class="kw">use</span> <span class="ident">kimchi::circuits::constraints</span>;
<span class="kw">use</span> <span class="ident">mina_curves::pasta</span>::{<span class="ident">fp::Fp</span>, <span class="ident">vesta</span>::{<span class="ident">Affine</span>, <span class="ident">VestaParameters</span>}, <span class="ident">pallas::Affine</span> <span class="kw">as</span> <span class="ident">Other</span>};
<span class="kw">use</span> <span class="ident">oracle</span>::{
    <span class="ident">constants::PlonkSpongeConstantsKimchi</span>,
    <span class="ident">sponge</span>::{<span class="ident">DefaultFqSponge</span>, <span class="ident">DefaultFrSponge</span>},
};
<span class="kw">use</span> <span class="ident">commitment_dlog::commitment</span>::{<span class="ident">b_poly_coefficients</span>, <span class="ident">ceil_log2</span>, <span class="ident">CommitmentCurve</span>};

<span class="kw">type</span> <span class="ident">SpongeParams</span> <span class="op">=</span> <span class="ident">PlonkSpongeConstantsKimchi</span>;
<span class="kw">type</span> <span class="ident">BaseSponge</span> <span class="op">=</span> <span class="ident">DefaultFqSponge</span><span class="op">&lt;</span><span class="ident">VestaParameters</span>, <span class="ident">SpongeParams</span><span class="op">&gt;</span>;
<span class="kw">type</span> <span class="ident">ScalarSponge</span> <span class="op">=</span> <span class="ident">DefaultFrSponge</span><span class="op">&lt;</span><span class="ident">Fp</span>, <span class="ident">SpongeParams</span><span class="op">&gt;</span>;

<span class="comment">// compile the circuit</span>
<span class="kw">let</span> <span class="ident">fp_sponge_params</span> <span class="op">=</span> <span class="ident">oracle::pasta::fp_kimchi::params</span>();
<span class="kw">let</span> <span class="ident">cs</span> <span class="op">=</span> <span class="ident">ConstraintSystem</span>::<span class="op">&lt;</span><span class="ident">Fp</span><span class="op">&gt;</span><span class="ident">::create</span>(<span class="ident">gates</span>, <span class="macro">vec!</span>[], <span class="ident">fp_sponge_params</span>, <span class="ident">public_size</span>).<span class="ident">unwrap</span>();

<span class="comment">// create an URS</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">urs</span> <span class="op">=</span> <span class="ident">SRS</span>::<span class="op">&lt;</span><span class="ident">Affine</span><span class="op">&gt;</span><span class="ident">::create</span>(<span class="ident">cs</span>.<span class="ident">domain</span>.<span class="ident">d1</span>.<span class="ident">size</span> <span class="kw">as</span> <span class="ident">usize</span>);
<span class="ident">srs</span>.<span class="ident">add_lagrange_basis</span>(<span class="ident">cs</span>.<span class="ident">domain</span>.<span class="ident">d1</span>);

<span class="comment">// obtain a prover index</span>
<span class="kw">let</span> <span class="ident">prover_index</span> <span class="op">=</span> {
    <span class="kw">let</span> <span class="ident">fq_sponge_params</span> <span class="op">=</span> <span class="ident">oracle::pasta::fq_kimchi::params</span>();
    <span class="kw">let</span> (<span class="ident">endo_q</span>, <span class="ident">_endo_r</span>) <span class="op">=</span> <span class="ident">endos</span>::<span class="op">&lt;</span><span class="ident">Other</span><span class="op">&gt;</span>();
    <span class="ident">Index</span>::<span class="op">&lt;</span><span class="ident">Affine</span><span class="op">&gt;</span><span class="ident">::create</span>(<span class="ident">cs</span>, <span class="ident">fq_sponge_params</span>, <span class="ident">endo_q</span>, <span class="ident">srs</span>)
};

<span class="comment">// obtain a verifier index</span>
<span class="kw">let</span> <span class="ident">verifier_index</span> <span class="op">=</span> <span class="ident">prover_index</span>.<span class="ident">verifier_index</span>();

<span class="comment">// create a proof</span>
<span class="kw">let</span> <span class="ident">group_map</span> <span class="op">=</span> <span class="op">&lt;</span><span class="ident">Affine</span> <span class="kw">as</span> <span class="ident">CommitmentCurve</span><span class="op">&gt;</span><span class="ident">::Map::setup</span>();
<span class="kw">let</span> <span class="ident">proof</span> <span class="op">=</span> {
    <span class="comment">// for recursion</span>
    <span class="kw">let</span> <span class="ident">k</span> <span class="op">=</span> <span class="ident">ceil_log2</span>(<span class="ident">index</span>.<span class="ident">srs</span>.<span class="ident">g</span>.<span class="ident">len</span>());
    <span class="kw">let</span> <span class="ident">chals</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="kw">_</span><span class="op">&gt;</span> <span class="op">=</span> (<span class="number">0</span>..<span class="ident">k</span>).<span class="ident">map</span>(<span class="op">|</span><span class="kw">_</span><span class="op">|</span> <span class="ident">Fp::rand</span>(<span class="ident">rng</span>)).<span class="ident">collect</span>();
    <span class="kw">let</span> <span class="ident">comm</span> <span class="op">=</span> {
        <span class="kw">let</span> <span class="ident">coeffs</span> <span class="op">=</span> <span class="ident">b_poly_coefficients</span>(<span class="kw-2">&amp;</span><span class="ident">chals</span>);
        <span class="kw">let</span> <span class="ident">b</span> <span class="op">=</span> <span class="ident">DensePolynomial::from_coefficients_vec</span>(<span class="ident">coeffs</span>);
        <span class="ident">index</span>.<span class="ident">srs</span>.<span class="ident">commit_non_hiding</span>(<span class="kw-2">&amp;</span><span class="ident">b</span>, <span class="prelude-val">None</span>)
    };
    (<span class="ident">chals</span>, <span class="ident">comm</span>)
    <span class="ident">ProverProof::create</span>::<span class="op">&lt;</span><span class="ident">BaseSponge</span>, <span class="ident">ScalarSponge</span><span class="op">&gt;</span>(<span class="kw-2">&amp;</span><span class="ident">group_map</span>, <span class="ident">witness</span>, <span class="kw-2">&amp;</span><span class="ident">prover_index</span>, <span class="macro">vec!</span>[<span class="ident">prev</span>])
};

<span class="comment">// verify a proof</span>
<span class="ident">batch_verify</span>::<span class="op">&lt;</span><span class="ident">Affine</span>, <span class="ident">BaseSponge</span>, <span class="ident">ScalarSponge</span><span class="op">&gt;</span>(<span class="kw-2">&amp;</span><span class="ident">group_map</span>, <span class="kw-2">&amp;</span>[(<span class="ident">verifier_index</span>, <span class="ident">proof</span>)]).<span class="ident">unwrap</span>();</code></pre></div>
<p>Note that kimchi is specifically designed for use in a recursion proof system, like <a href="https://medium.com/minaprotocol/meet-pickles-snark-enabling-smart-contract-on-coda-protocol-7ede3b54c250">pickles</a>, but can also be used a stand alone for normal proofs.</p>
<h3 id="organization"><a href="#organization">Organization</a></h3>
<p>The project is organized in the following way:</p>
<ul>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/book">book/</a>. The mina book, RFCs, and specifications.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/cairo">cairo/</a>. A Cairo runner written in rust.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/curves">curves/</a>. The elliptic curves we use (for now just the pasta curves).</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/groupmap">groupmap/</a>. Used to convert elliptic curve elements to field elements.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/hasher">hasher/</a>. Interfaces for mina hashing.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/kimchi">kimchi/</a>. Our proof system.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/ocaml">ocaml/</a>. Ocaml bindings generator tool.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/oracle">oracle/</a>. Implementation of the poseidon hash function.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/poly-commitment">poly-commitment/</a>. Polynomial commitment code.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/signer">signer/</a>. Interfaces for mina signature schemes.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/tools">tools/</a>. Various tooling to help us work on kimchi.</li>
<li><a href="https://github.com/o1-labs/proof-systems/tree/master/utils">utils/</a>. Collection of useful functions and traits.</li>
</ul>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="alphas/index.html" title="kimchi::alphas mod">alphas</a></div><div class="item-right docblock-short"><p>This module implements an abstraction to keep track of the powers of alphas.
As a recap, alpha is a challenge sent by the verifier in PLONK,
and is used to aggregate multiple constraints into a single polynomial.
It is important that different constraints use different powers of alpha,
as otherwise they can interact and potentially cancel one another.
(The proof is in the use of the Schwartz-Zippel lemma.)
As such, we want two properties from this:</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="bench/index.html" title="kimchi::bench mod">bench</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="circuits/index.html" title="kimchi::circuits mod">circuits</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="error/index.html" title="kimchi::error mod">error</a></div><div class="item-right docblock-short"><p>This module implements the <a href="error/enum.ProofError.html" title="ProofError">ProofError</a> type.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="linearization/index.html" title="kimchi::linearization mod">linearization</a></div><div class="item-right docblock-short"><p>This module implements the linearization.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="plonk_sponge/index.html" title="kimchi::plonk_sponge mod">plonk_sponge</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="prover/index.html" title="kimchi::prover mod">prover</a></div><div class="item-right docblock-short"><p>This module implements prover’s zk-proof primitive.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="prover_index/index.html" title="kimchi::prover_index mod">prover_index</a></div><div class="item-right docblock-short"><p>This module implements the prover index as <a href="prover_index/struct.ProverIndex.html" title="ProverIndex">ProverIndex</a>.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="verifier/index.html" title="kimchi::verifier mod">verifier</a></div><div class="item-right docblock-short"><p>This module implements zk-proof batch verifier functionality.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="verifier_index/index.html" title="kimchi::verifier_index mod">verifier_index</a></div><div class="item-right docblock-short"><p>This module implements the verifier index as <a href="verifier_index/struct.VerifierIndex.html" title="VerifierIndex">VerifierIndex</a>.
You can derive this struct from the <a href="prover_index/struct.ProverIndex.html" title="ProverIndex">ProverIndex</a> struct.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="kimchi" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0-nightly (58f11791a 2022-03-17)" ></div>
</body></html>