"use strict";(globalThis.webpackChunkmina_book=globalThis.webpackChunkmina_book||[]).push([[830],{8213(s,e,n){n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>m});const i=JSON.parse('{"id":"kimchi/custom_constraints","title":"Custom Constraints","description":"This section explains how to design and add a custom constraint to our","source":"@site/docs/kimchi/custom_constraints.md","sourceDirName":"kimchi","slug":"/kimchi/custom_constraints","permalink":"/proof-systems/kimchi/custom_constraints","draft":false,"unlisted":false,"editUrl":"https://github.com/o1-labs/proof-systems/tree/master/book/docs/kimchi/custom_constraints.md","tags":[],"version":"current","frontMatter":{"title":"Custom Constraints"},"sidebar":"docsSidebar","previous":{"title":"Extended lookup tables","permalink":"/proof-systems/kimchi/extended-lookup-tables"},"next":{"title":"gates","permalink":"/proof-systems/kimchi/gates"}}');var a=n(4848),t=n(8453);const r={title:"Custom Constraints"},l=void 0,c={},m=[{value:"Specifying a constraint",id:"specifying-a-constraint",level:2},{value:"Defining a PLONK configuration",id:"defining-a-plonk-configuration",level:2}];function o(s){const e={annotation:"annotation",blockquote:"blockquote",code:"code",h2:"h2",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...s.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.p,{children:["This section explains how to design and add a custom constraint to our\n",(0,a.jsx)(e.code,{children:"proof-systems"})," library."]}),"\n",(0,a.jsx)(e.p,{children:"PLONK is an AIOP. That is, it is a protocol in which the prover sends\npolynomials as messages and the verifier sends random challenges, and then\nevaluates the prover's polynomials and performs some final checks on the\noutputs."}),"\n",(0,a.jsx)(e.p,{children:"PLONK is very flexible. It can be customized with constraints specific to\ncomputations of interest. For example, in Mina, we use a PLONK configuration\ncalled kimchi that has custom constraints for poseidon hashing, doing elliptic\ncurve operations, and more."}),"\n",(0,a.jsx)(e.p,{children:'A "PLONK configuration" specifies'}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"The set of types of constraints that you would like to be able to enforce. We\nwill describe below how these types of constraints are specified."}),"\n",(0,a.jsxs)(e.li,{children:['A number of "eq-able" columns ',(0,a.jsx)(e.code,{children:"W"})]}),"\n",(0,a.jsxs)(e.li,{children:['A number of "advice" columns ',(0,a.jsx)(e.code,{children:"A"})]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"Under such configuration, a circuit is specified by"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["A number of rows ",(0,a.jsx)(e.code,{children:"n"})]}),"\n",(0,a.jsxs)(e.li,{children:["A vector ",(0,a.jsx)(e.code,{children:"cs"})," of constraint-types of length ",(0,a.jsx)(e.code,{children:"n"}),". I.e., a vector that\nspecifies, for each row, which types of constraints should be enforced on that\nrow."]}),"\n",(0,a.jsxs)(e.li,{children:["A vector ",(0,a.jsx)(e.code,{children:"eqs : Vec<(Position, Position)>"})," of equalities to enforce, where\n",(0,a.jsx)(e.code,{children:"struct Position { row: usize, column: usize }"}),". E.g., if the pair\n",(0,a.jsx)(e.code,{children:"(Position { row: 0, col: 8 }, Position { row: 10, col: 2 })"})," is in ",(0,a.jsx)(e.code,{children:"eqs"}),',\nthen the circuit is saying the entries in those two positions should be equal,\nor in other words that they refer to the same value. This is where the\ndistinction between "eq-able" and "advice" columns comes in. The ',(0,a.jsx)(e.code,{children:"column"}),"\nfield of a position in the ",(0,a.jsx)(e.code,{children:"eqs"})," array can only refer to one of the first ",(0,a.jsx)(e.code,{children:"W"}),"\ncolumns. Equalities cannot be enforced on entries in the ",(0,a.jsx)(e.code,{children:"A"})," columns after\nthat."]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"Then, given such a circuit, PLONK lets you produce proofs for the statement"}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsxs)(e.p,{children:["I know ",(0,a.jsx)(e.code,{children:"W + A"}),' "column vectors" of field elements ',(0,a.jsx)(e.code,{children:"vs: [Vec<F>; W + A]"})," such\nthat for each row index ",(0,a.jsx)(e.code,{children:"i < n"}),", the constraint of type ",(0,a.jsx)(e.code,{children:"cs[i]"})," holds on the\nvalues ",(0,a.jsx)(e.code,{children:"[vs[0][i], ..., vs[W+A - 1][i], vs[0][i+1], ..., vs[W+A - 1][i+1]"})," and\nall the equalities in ",(0,a.jsx)(e.code,{children:"eqs"})," hold. I.e., for ",(0,a.jsx)(e.code,{children:"(p1, p2)"})," in ",(0,a.jsx)(e.code,{children:"eqs"})," we have\n",(0,a.jsx)(e.code,{children:"vs[p1.col][p1.row] == vs[p2.col][p2.row]"}),". So, a constraint can check the\nvalues in two adjacent rows."]}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"specifying-a-constraint",children:"Specifying a constraint"}),"\n",(0,a.jsxs)(e.p,{children:["Mathematically speaking, a constraint is a multivariate polynomial over the\nvariables\n",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"c"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"C"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"u"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"r"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"r"})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mi,{children:"i"})]})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mo,{children:"\u2026"}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"v"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"C"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"u"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"r"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"r"})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mi,{children:"W"}),(0,a.jsx)(e.mo,{children:"+"}),(0,a.jsx)(e.mi,{children:"A"}),(0,a.jsx)(e.mo,{children:"\u2212"}),(0,a.jsx)(e.mn,{children:"1"})]})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"v"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"N"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"e"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"x"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"t"})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mn,{children:"0"})]})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mo,{children:"\u2026"}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"v"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"N"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"e"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"x"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"t"})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mi,{children:"W"}),(0,a.jsx)(e.mo,{children:"+"}),(0,a.jsx)(e.mi,{children:"A"}),(0,a.jsx)(e.mo,{children:"\u2212"}),(0,a.jsx)(e.mn,{children:"1"})]})]})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"c_{\\mathsf{Curr},i}, \\dots, v_{\\mathsf{Curr}, W+A-1}, v_{\\mathsf{Next}, 0}, \\dots, v_{\\mathsf{Next}, W+A-1}"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.7167em",verticalAlign:"-0.2861em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",children:"c"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathsf mtight",style:{marginRight:"0.01389em"},children:"Curr"})}),(0,a.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mpunct",children:","}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(e.span,{className:"minner",children:"\u2026"}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(e.span,{className:"mpunct",children:","}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathsf mtight",style:{marginRight:"0.01389em"},children:"Curr"})}),(0,a.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"W"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"A"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,a.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mpunct",children:","}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathsf mtight",children:"Next"})}),(0,a.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,a.jsx)(e.span,{className:"mord mtight",children:"0"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mpunct",children:","}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(e.span,{className:"minner",children:"\u2026"}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(e.span,{className:"mpunct",children:","}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathsf mtight",children:"Next"})}),(0,a.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"W"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"A"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,a.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]}),'.\nIn other words, there is one variable corresponding to the value of each column\nin the "current row" and one variable correspond to the value of each column in\nthe "next row".']}),"\n",(0,a.jsxs)(e.p,{children:["In Rust, ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"v"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"r"}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mi,{children:"i"})]})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"v_{r, i}"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.7167em",verticalAlign:"-0.2861em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"}),(0,a.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})," is written ",(0,a.jsx)(e.code,{children:"E::cell(Column::Witness(i), r)"}),". So, for\nexample, the variable ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"v"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"N"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"e"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"x"}),(0,a.jsx)(e.mi,{mathvariant:"sans-serif",children:"t"})]}),(0,a.jsx)(e.mo,{separator:"true",children:","}),(0,a.jsx)(e.mn,{children:"3"})]})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"v_{\\mathsf{Next}, 3}"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.7167em",verticalAlign:"-0.2861em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathsf mtight",children:"Next"})}),(0,a.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,a.jsx)(e.span,{className:"mord mtight",children:"3"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})," is written\n",(0,a.jsx)(e.code,{children:"E::cell(Column::Witness(3), CurrOrNext::Next)"}),"."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"let w = |i| v(Column::Witness(i));\n"})}),"\n",(0,a.jsx)(e.p,{children:"Let's"}),"\n",(0,a.jsx)(e.h2,{id:"defining-a-plonk-configuration",children:"Defining a PLONK configuration"}),"\n",(0,a.jsxs)(e.p,{children:["The art in proof systems comes from knowing how to design a PLONK configuration\nto ensure maximal efficiency for the sorts of computations you are trying to\nprove. That is, how to choose the numbers of columns ",(0,a.jsx)(e.code,{children:"W"})," and ",(0,a.jsx)(e.code,{children:"A"}),", and how to\ndefine the set of constraint types."]}),"\n",(0,a.jsx)(e.p,{children:"Let's describe the trade-offs involved here."}),"\n",(0,a.jsx)(e.p,{children:"The majority of the proving time for the PLONK prover is in"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["committing to the ",(0,a.jsx)(e.code,{children:"W + A"})," column polynomials, which have length equal to the\nnumber of rows ",(0,a.jsx)(e.code,{children:"n"})]}),"\n",(0,a.jsxs)(e.li,{children:['committing to the "permutation accumulator polynomial, which has length ',(0,a.jsx)(e.code,{children:"n"}),"."]}),"\n",(0,a.jsxs)(e.li,{children:["committing to the quotient polynomial, which reduces to computing ",(0,a.jsx)(e.code,{children:"max(k, W)"}),"\nMSMs of size ",(0,a.jsx)(e.code,{children:"n"}),", where ",(0,a.jsx)(e.code,{children:"k"})," is the max degree of a constraint."]}),"\n",(0,a.jsxs)(e.li,{children:["performing the commitment opening proof, which is mostly dependent on the\nnumber of rows ",(0,a.jsx)(e.code,{children:"n"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:["So all in all, the proving time is approximately equal to the time to perform\n",(0,a.jsx)(e.code,{children:"W + A + 1 + max(k - 1, W)"})," MSMs of size ",(0,a.jsx)(e.code,{children:"n"}),", plus the cost of an opening proof\nfor polynomials of degree ",(0,a.jsx)(e.code,{children:"n - 1"}),"."]}),"\n",(0,a.jsx)(e.p,{children:"and maybe"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsxs)(e.p,{children:["computing the combined constraint polynomial, which has degree ",(0,a.jsx)(e.code,{children:"k * n"})," where\n",(0,a.jsx)(e.code,{children:"k"})," is the maximum degree of a constraint"]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsxs)(e.p,{children:["Increasing ",(0,a.jsx)(e.code,{children:"W"})," and ",(0,a.jsx)(e.code,{children:"A"})," increase proof size, and they potentially impact the\nprover-time as the prover must compute polynomial commitments to each column,\nand computing a polynomial commitment corresponds to doing one MSM\n(multi-scalar multiplication, also called a multi-exponentiation.)"]}),"\n",(0,a.jsx)(e.p,{children:"However, often increasing the number of columns allows you to decrease the\nnumber of rows required for a given computation. For example, if you can\nperform one Poseidon hash in 36 rows with 5 total columns, then you can also\nperform it in 12 (= 36 / 3) rows with 15 (= 5 * 3) total columns."}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"Decreasing the number of rows (even while keeping the total number of table\nentries the same) is desirable because it reduces the cost of the polynomial\ncommitment opening proof, which is dominated by a factor linear in the number\nof rows, and barely depends on the number of columns."})}),"\n",(0,a.jsx)(e.p,{children:"Increasing the number of columns also increases verifier time, as the verifier\nmust perform one scalar-multiplication and one hash per column. Proof length\nis also affected by a larger number of columns, as more polynomials need to be\ncommitted and sent along to the verifier."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"There is typically some interplay between these"})]})}function h(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,a.jsx)(e,{...s,children:(0,a.jsx)(o,{...s})}):o(s)}},8453(s,e,n){n.d(e,{R:()=>r,x:()=>l});var i=n(6540);const a={},t=i.createContext(a);function r(s){const e=i.useContext(t);return i.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function l(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(a):s.components||a:r(s.components),i.createElement(t.Provider,{value:e},s.children)}}}]);