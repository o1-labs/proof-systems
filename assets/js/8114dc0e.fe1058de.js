"use strict";(globalThis.webpackChunkmina_book=globalThis.webpackChunkmina_book||[]).push([[4695],{2352(s,a,e){e.r(a),e.d(a,{assets:()=>m,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"fundamentals/zkbook_2pc/fkaes","title":"Fixed-Key-AES Hashes","description":"Using fixed-key AES as a hash function in this context can be traced back to the","source":"@site/docs/fundamentals/zkbook_2pc/fkaes.md","sourceDirName":"fundamentals/zkbook_2pc","slug":"/fundamentals/zkbook_2pc/fkaes","permalink":"/proof-systems/fundamentals/zkbook_2pc/fkaes","draft":false,"unlisted":false,"editUrl":"https://github.com/o1-labs/proof-systems/tree/master/book/docs/fundamentals/zkbook_2pc/fkaes.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Full Description","permalink":"/proof-systems/fundamentals/zkbook_2pc/fulldesc"},"next":{"title":"Oblivious Transfer","permalink":"/proof-systems/fundamentals/zkbook_2pc/ot"}}');var i=e(4848),t=e(8453);const r={},l="Fixed-Key-AES Hashes",m={},c=[];function h(s){const a={a:"a",annotation:"annotation",h1:"h1",header:"header",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mstyle:"mstyle",p:"p",semantics:"semantics",span:"span",...(0,t.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"fixed-key-aes-hashes",children:"Fixed-Key-AES Hashes"})}),"\n",(0,i.jsxs)(a.p,{children:["Using fixed-key AES as a hash function in this context can be traced back to the\nwork of Bellare et al. ",(0,i.jsx)(a.a,{href:"https://eprint.iacr.org/2013/426.pdf",children:"BHKR13"}),", who\nconsidered fixed-key AES for circuit garbling. Prior to that point, most\nimplementations of garbled circuits used a hash function such as ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsx)(a.mrow,{children:(0,i.jsxs)(a.mstyle,{mathsize:"0.9em",children:[(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"S"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"H"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"A"})]}),(0,i.jsx)(a.mn,{children:"256"})]})}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"\\sha"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.625em"}}),(0,i.jsxs)(a.span,{className:"mord",children:[(0,i.jsx)(a.span,{className:"mord sizing reset-size6 size5",children:(0,i.jsx)(a.span,{className:"mord mathsf",children:"SHA"})}),(0,i.jsx)(a.span,{className:"mord sizing reset-size6 size5",children:"256"})]})]})})]}),",\nmodelled as a random oracle. But Bellare et al. showed that using fixed-key AES\ncan be up to ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mn,{children:"50"}),(0,i.jsx)(a.mo,{children:"\xd7"})]}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"50\\times"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(a.span,{className:"mord",children:"50"}),(0,i.jsx)(a.span,{className:"mord",children:"\xd7"})]})})]})," faster than using a cryptographic hash function due to\nhardware support for AES provided by modern processors."]}),"\n",(0,i.jsxs)(a.p,{children:["Prior to ",(0,i.jsx)(a.a,{href:"https://eprint.iacr.org/2013/426.pdf",children:"BHKR13"})," CPU time was the main\nbottleneck for protocols based on circuit garbling; after the introduction of\nfixed-key cipher garbling, network throughput became the dominant factor. For\nthis reason, fixed-key AES has been almost universally adopted in subsequent\nimplementations of garbled circuits."]}),"\n",(0,i.jsxs)(a.p,{children:["Several instantiations of hash function based on fix-key AES are proposed\ninspired by the work of Bellare et al. However, most of them have some security\nflaws as pointed out by ",(0,i.jsx)(a.a,{href:"https://eprint.iacr.org/2019/074.pdf",children:"GKWY20"}),". (GKWY20)\nalso proposes a provable secure instantiation satisfies the property called\nTweakable Circular Correlation Robustness (TCCR). More discussions about the\nconcrete security of fixed-key AES based hash are introduced in\n",(0,i.jsx)(a.a,{href:"https://eprint.iacr.org/2019/1168.pdf",children:"GKWWY20"}),"."]}),"\n",(0,i.jsx)(a.p,{children:"The TCCR hash based on fixed-key AES is defined as follows."}),"\n",(0,i.jsxs)(a.p,{children:[(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mstyle,{mathsize:"0.9em",children:(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"H"})}),(0,i.jsx)(a.mo,{stretchy:"false",children:"("}),(0,i.jsx)(a.mi,{children:"i"}),(0,i.jsx)(a.mo,{separator:"true",children:","}),(0,i.jsx)(a.mi,{children:"x"}),(0,i.jsx)(a.mo,{stretchy:"false",children:")"}),(0,i.jsx)(a.mo,{children:"="}),(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"T"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"C"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"C"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"R"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"_"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"H"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"a"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"s"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"h"})]}),(0,i.jsx)(a.mo,{stretchy:"false",children:"("}),(0,i.jsx)(a.mi,{children:"i"}),(0,i.jsx)(a.mo,{separator:"true",children:","}),(0,i.jsx)(a.mi,{children:"x"}),(0,i.jsx)(a.mo,{stretchy:"false",children:")"}),(0,i.jsx)(a.mo,{children:"="}),(0,i.jsx)(a.mi,{children:"\u03c0"}),(0,i.jsx)(a.mo,{stretchy:"false",children:"("}),(0,i.jsx)(a.mi,{children:"\u03c0"}),(0,i.jsx)(a.mo,{stretchy:"false",children:"("}),(0,i.jsx)(a.mi,{children:"x"}),(0,i.jsx)(a.mo,{stretchy:"false",children:")"}),(0,i.jsx)(a.mo,{children:"\u2295"}),(0,i.jsx)(a.mi,{children:"i"}),(0,i.jsx)(a.mo,{stretchy:"false",children:")"}),(0,i.jsx)(a.mo,{children:"\u2295"}),(0,i.jsx)(a.mi,{children:"\u03c0"}),(0,i.jsx)(a.mo,{stretchy:"false",children:"("}),(0,i.jsx)(a.mi,{children:"x"}),(0,i.jsx)(a.mo,{stretchy:"false",children:")"}),(0,i.jsx)(a.mo,{separator:"true",children:","})]}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"\\sH(i,x) = \\mathsf{TCCR\\_Hash}(i,x) = \\pi(\\pi(x)\\oplus i)\\oplus\\pi(x),"})]})})}),(0,i.jsxs)(a.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(a.span,{className:"mord",children:(0,i.jsx)(a.span,{className:"mord mathsf sizing reset-size6 size5",children:"H"})}),(0,i.jsx)(a.span,{className:"mopen",children:"("}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(a.span,{className:"mpunct",children:","}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(a.span,{className:"mclose",children:")"}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(a.span,{className:"mrel",children:"="}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"1.1em",verticalAlign:"-0.35em"}}),(0,i.jsx)(a.span,{className:"mord",children:(0,i.jsx)(a.span,{className:"mord mathsf",children:"TCCR_Hash"})}),(0,i.jsx)(a.span,{className:"mopen",children:"("}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(a.span,{className:"mpunct",children:","}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(a.span,{className:"mclose",children:")"}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(a.span,{className:"mrel",children:"="}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"}),(0,i.jsx)(a.span,{className:"mopen",children:"("}),(0,i.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"}),(0,i.jsx)(a.span,{className:"mopen",children:"("}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(a.span,{className:"mclose",children:")"}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(a.span,{className:"mbin",children:"\u2295"}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(a.span,{className:"mclose",children:")"}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(a.span,{className:"mbin",children:"\u2295"}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"}),(0,i.jsx)(a.span,{className:"mopen",children:"("}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(a.span,{className:"mclose",children:")"}),(0,i.jsx)(a.span,{className:"mpunct",children:","})]})]})]})," where\n",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsx)(a.mrow,{children:(0,i.jsx)(a.mi,{children:"x"})}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"x"})]})})]})," is a ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsx)(a.mrow,{children:(0,i.jsx)(a.mn,{children:"128"})}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"128"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(a.span,{className:"mord",children:"128"})]})})]}),"-bit string, ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsx)(a.mrow,{children:(0,i.jsx)(a.mi,{children:"i"})}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"i"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"i"})]})})]})," a public ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsx)(a.mrow,{children:(0,i.jsx)(a.mn,{children:"128"})}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"128"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(a.span,{className:"mord",children:"128"})]})})]}),"-bit ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"t"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"w"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"e"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"a"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"k"})]}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"\\mathsf{tweak}"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(a.span,{className:"mord",children:(0,i.jsx)(a.span,{className:"mord mathsf",children:"tweak"})})]})})]}),", and\n",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mi,{children:"\u03c0"}),(0,i.jsx)(a.mo,{stretchy:"false",children:"("}),(0,i.jsx)(a.mi,{children:"x"}),(0,i.jsx)(a.mo,{stretchy:"false",children:")"}),(0,i.jsx)(a.mo,{children:"="}),(0,i.jsx)(a.mstyle,{mathsize:"0.9em",children:(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"A"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"E"}),(0,i.jsx)(a.mi,{mathvariant:"sans-serif",children:"S"})]})}),(0,i.jsx)(a.mo,{stretchy:"false",children:"("}),(0,i.jsx)(a.mi,{children:"k"}),(0,i.jsx)(a.mo,{separator:"true",children:","}),(0,i.jsx)(a.mi,{children:"x"}),(0,i.jsx)(a.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"\\pi(x) = \\aes(k,x)"})]})})}),(0,i.jsxs)(a.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"}),(0,i.jsx)(a.span,{className:"mopen",children:"("}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(a.span,{className:"mclose",children:")"}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(a.span,{className:"mrel",children:"="}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(a.span,{className:"mord",children:(0,i.jsx)(a.span,{className:"mord sizing reset-size6 size5",children:(0,i.jsx)(a.span,{className:"mord mathsf",children:"AES"})})}),(0,i.jsx)(a.span,{className:"mopen",children:"("}),(0,i.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,i.jsx)(a.span,{className:"mpunct",children:","}),(0,i.jsx)(a.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(a.span,{className:"mclose",children:")"})]})]})]})," for any fixed-key ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsx)(a.mrow,{children:(0,i.jsx)(a.mi,{children:"k"})}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]}),"."]})]})}function d(s={}){const{wrapper:a}={...(0,t.R)(),...s.components};return a?(0,i.jsx)(a,{...s,children:(0,i.jsx)(h,{...s})}):h(s)}},8453(s,a,e){e.d(a,{R:()=>r,x:()=>l});var n=e(6540);const i={},t=n.createContext(i);function r(s){const a=n.useContext(t);return n.useMemo(function(){return"function"==typeof s?s(a):{...a,...s}},[a,s])}function l(s){let a;return a=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:r(s.components),n.createElement(t.Provider,{value:a},s.children)}}}]);