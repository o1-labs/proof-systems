"use strict";(globalThis.webpackChunkmina_book=globalThis.webpackChunkmina_book||[]).push([[3440],{1386(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"snarky/circuit-generation","title":"Circuit generation","description":"In circuit generation mode, the has_witness field of RunState is set to the","source":"@site/docs/snarky/circuit-generation.md","sourceDirName":"snarky","slug":"/snarky/circuit-generation","permalink":"/proof-systems/snarky/circuit-generation","draft":false,"unlisted":false,"editUrl":"https://github.com/o1-labs/proof-systems/tree/master/book/docs/snarky/circuit-generation.md","tags":[],"version":"current","frontMatter":{}}');var i=t(4848),s=t(8453);const a={},o="Circuit generation",c={},l=[{value:"Creation of variables",id:"creation-of-variables",level:2},{value:"Constraints",id:"constraints",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"circuit-generation",children:"Circuit generation"})}),"\n",(0,i.jsxs)(n.p,{children:["In circuit generation mode, the ",(0,i.jsx)(n.code,{children:"has_witness"})," field of ",(0,i.jsx)(n.code,{children:"RunState"})," is set to the\ndefault ",(0,i.jsx)(n.code,{children:"CircuitGeneration"}),", and the program of the user is ran to completion."]}),"\n",(0,i.jsxs)(n.p,{children:["During the execution, the different snarky functions called on ",(0,i.jsx)(n.code,{children:"RunState"})," will\ncreate ",(0,i.jsx)(n.a,{href:"/proof-systems/snarky/vars",children:"internal variables"})," as well as constraints."]}),"\n",(0,i.jsx)(n.h2,{id:"creation-of-variables",children:"Creation of variables"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/proof-systems/snarky/vars",children:"Variables"})," can be created via the ",(0,i.jsx)(n.code,{children:"compute()"})," function, which takes\ntwo arguments:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["A ",(0,i.jsx)(n.code,{children:"TypeCreation"})," toggle, which is either set to ",(0,i.jsx)(n.code,{children:"Checked"})," or ",(0,i.jsx)(n.code,{children:"Unsafe"}),". We will\ndescribe this below."]}),"\n",(0,i.jsxs)(n.li,{children:["A closure representing the actual computation behind the variable. This\ncomputation will only take place when real values are computed, and can be\nnon-deterministic (e.g. random, or external values provided by the user). Note\nthat the closure takes one argument: a ",(0,i.jsx)(n.code,{children:"WitnessGeneration"}),", a structure that\nallows you to read the runtime values of any variables that were previously\ncreated in your program."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"compute()"})," function also needs a type hint to understand what type of\n",(0,i.jsx)(n.a,{href:"/proof-systems/snarky/vars#snarky-vars",children:"snarky type"})," it is creating."]}),"\n",(0,i.jsx)(n.p,{children:"It then performs the following steps:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["creates enough ",(0,i.jsx)(n.a,{href:"./vars#circuit-vars",children:(0,i.jsx)(n.code,{children:"FieldVar"})})," to hold the value to be\ncreated"]}),"\n",(0,i.jsxs)(n.li,{children:["retrieves the auxiliary data needed to create the snarky type (TODO: explain\nauxiliary data) and create the ",(0,i.jsx)(n.a,{href:"/proof-systems/snarky/vars#snarky-vars",children:(0,i.jsx)(n.code,{children:"snarky variable"})})," out\nof the ",(0,i.jsx)(n.code,{children:"FieldVar"}),"s and the auxiliary data"]}),"\n",(0,i.jsxs)(n.li,{children:["if the ",(0,i.jsx)(n.code,{children:"TypeCreation"})," is set to ",(0,i.jsx)(n.code,{children:"Checked"}),", call the ",(0,i.jsx)(n.code,{children:"check()"})," function on the\nsnarky type (which will constrain the value created), if it is set to ",(0,i.jsx)(n.code,{children:"Unsafe"}),"\ndo nothing (in which case we're trusting that the value cannot be malformed,\nthis is mostly used internally and it is highly-likely that users directly\nmaking use of ",(0,i.jsx)(n.code,{children:"Unsafe"})," are writing bugs)"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["At this point we only created variables to hold future values, and made sure\nthat they are constrained. The actual values will fill the room created by the\n",(0,i.jsx)(n.code,{children:"FieldVar"})," only during the witness generation phase."]})}),"\n",(0,i.jsx)(n.h2,{id:"constraints",children:"Constraints"}),"\n",(0,i.jsx)(n.p,{children:"All other functions exposed by the API are basically here to operate on\nvariables and create constraints in doing so."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);